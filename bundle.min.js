(()=>{document.addEventListener("DOMContentLoaded",async()=>{let r="https://pwnysdqtryhpsxbwduxx.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB3bnlzZHF0cnlocHN4YndkdXh4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDAyNTgxMDgsImV4cCI6MjA1NTgzNDEwOH0.fdasu8s64B9wN9sh6zTQ3WLwX-4d_sfAMzMODMfDF1o",d=document.querySelector(".iframe__nav"),S=document.querySelector(".seo__wrapper"),m=document.querySelector(".skeleton-container"),c=document.querySelector(".iframe__categorias-container"),u=document.querySelector("#producto-template");if(!c||!u){console.error("Error: No se encontr\xF3 .iframe__categorias-container o el template");return}let h=()=>{let t=document.createElement("div");return t.classList.add("skeleton"),t.innerHTML=`
         <div class="skeleton-image"></div>
         <div class="skeleton-text"></div>
      `,t},a=()=>{let s=window.innerWidth<=768?18:12;m.innerHTML="";for(let l=0;l<s;l++)m.appendChild(h())},y=t=>t.replace(/(\d+%|ofertas|\$\d{1,3}(\.\d{3})*(,\d+)?|\d+\s*(ml|ML)|ENVÍO\sGRATIS)/gi,s=>`<span class="iframe__categorias-span" style="font-weight: bold; color: red;">${s}</span>`),g=t=>t?/SOLO X \d+ HORAS/i.test(t)||t.toUpperCase()==="AGOTADO"?{borderColor:"red",bgColor:"red",textColor:"white",text:t.toUpperCase(),borderWidth:"3px"}:t.toUpperCase()==="LANZAMIENTO"?{borderColor:"#aad500",bgColor:"#aad500",textColor:"black",text:"LANZAMIENTO",borderWidth:"3px"}:{borderColor:"rgb(223, 223, 223)",bgColor:"transparent",textColor:"black",text:"",borderWidth:"1px"}:{borderColor:"rgb(223, 223, 223)",bgColor:"transparent",textColor:"black",text:"",borderWidth:"1px"},f=async()=>{try{a();let t=window.supabase.createClient(r,n),{data:s,error:l}=await t.from("cyber").select("*").order("orderSellout",{ascending:!0}),b=new Date().getTime();localStorage.setItem("productosData",JSON.stringify(s)),localStorage.setItem("productosTimestamp",b),m.style.display="none",w(s)}catch(t){console.error("Error al cargar los datos:",t)}},w=t=>{let s=new Date;s.setHours(0,0,0,0),c.innerHTML="";let l=document.createDocumentFragment();if(t.some(e=>/SOLO X \d+ HORAS/i.test(e.estado_oferta))&&!document.querySelector('[data-category-name="SoloX"]')){let e=document.querySelector(".iframe__nav"),o=document.createElement("a");o.href="#SoloX",o.className="iframe__nav-item",o.dataset.categoryName="SoloX",o.textContent="Solo X Horas",e.appendChild(o)}t.filter(e=>{let o=new Date(e.startDate),i=new Date(e.endDate);return!e.isProductHidden&&s>=o&&s<=i}).sort((e,o)=>e.orden_sellout-o.orden_sellout).forEach(e=>{let o=g(e.offerState),i=u.content.cloneNode(!0),p=i.querySelector(".iframe__categorias-link"),L=i.querySelector(".iframe__categorias-image"),I=i.querySelector(".iframe__categorias-productTitle"),C=i.querySelector(".iframe__tag--desk"),v=i.querySelector(".iframe__tag--mobile");p.href=e.urlProduct,p.dataset.id=e.id,p.dataset.title=e.title,/SOLO X \d+ HORAS/i.test(e.offerState)?p.dataset.category=`${e.category} SoloX`:p.dataset.category=e.category,L.src=e.urlImage,L.alt=e.title||"Imagen de producto",L.style.border=`${o.borderWidth} solid ${o.borderColor}`,I.innerHTML=y(e.title||""),o.text?(C.style.backgroundColor=o.bgColor,C.style.color=o.textColor,C.innerHTML=`<b class="iframe__tag--bold">${o.text}</b>`,v.style.backgroundColor=o.bgColor,v.style.color=o.textColor,v.innerHTML=`<b class="iframe__tag--bold">${o.text}</b>`):(C.remove(),v.remove()),l.appendChild(i)}),c.appendChild(l),d.style.opacity="0",d.style.display="flex",S.style.display="block",setTimeout(()=>{c.classList.add("iframe__categorias-container--show"),d.style.transition="opacity 0.5s ease-in-out",d.style.opacity="1";let e=new Event("navCargado");document.dispatchEvent(e)},100)};(()=>{let t=localStorage.getItem("productosData"),s=localStorage.getItem("productosTimestamp"),l=new Date().getTime(),b=5*60*1e3;if(t&&s&&l-s<b){let e=JSON.parse(t);m.style.display="none",w(e)}else f()})()});document.addEventListener("navCargado",()=>{let r=document.querySelector(".iframe__nav"),n=document.querySelectorAll(".iframe__nav-item"),d=document.querySelectorAll(".iframe__categorias-link"),S=document.querySelector(".iframe__banner"),m=document.querySelector('[data-category-name="VerTodo"]'),c="VerTodo",u=()=>{d.forEach(a=>a.style.display="block")},h=a=>{d.forEach(y=>{let f=(y.getAttribute("data-category")||"").split(" ");y.style.display=f.includes(a)?"block":"none"})};u(),n.forEach(a=>{a.addEventListener("click",function(y){y.preventDefault();let g=a.getAttribute("data-category-name");n.forEach(f=>f.classList.remove("selected","ver-todo-active")),g==="VerTodo"?(c="VerTodo",u(),a.classList.add("ver-todo-active")):(c=g,h(g)),a.classList.add("selected"),r.scrollTo({left:a.offsetLeft-r.offsetLeft,behavior:"smooth"})})}),S.addEventListener("click",()=>{c="VerTodo",u(),n.forEach(a=>a.classList.remove("selected","ver-todo-active")),m.classList.add("selected","ver-todo-active"),r.scrollTo({left:m.offsetLeft-r.offsetLeft,behavior:"smooth"})})});var k=0,x;function _(){let r=document.querySelector(".main__container");if(r){let n=r.getBoundingClientRect().height;n>0&&n!==k&&(window.parent.postMessage(n,"*"),k=n)}}window.addEventListener("load",()=>{_()});document.addEventListener("navCargado",()=>{_(),E()});function E(){let r=document.querySelector(".main__container"),n={attributes:!0,childList:!0,subtree:!0};r&&(x=new MutationObserver(_),x.observe(r,n))}setTimeout(()=>{_(),E()},4e3);var T=document.querySelector(".seo__toggle-btn");T.addEventListener("click",()=>{let r=document.getElementById("seoContent");r.style.display==="none"||r.style.display===""?(r.style.display="block",T.textContent="Ver menos"):(r.style.display="none",T.textContent="Ver m\xE1s")});})();
