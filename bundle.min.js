(()=>{document.addEventListener("DOMContentLoaded",async()=>{localStorage.removeItem("productosData"),localStorage.removeItem("productosTimestamp");let r="https://pwnysdqtryhpsxbwduxx.supabase.co/storage/v1/object/public/cache/listProducts.json",a=document.querySelector(".iframe__nav"),f=document.querySelector(".seo__wrapper"),y=document.querySelector(".skeleton-container"),i=document.querySelector(".iframe__categorias-container"),d=document.querySelector("#producto-template");if(!i||!d){console.error("Error: No se encontr\xF3 .iframe__categorias-container o el template");return}let g=()=>{let t=document.createElement("div");return t.classList.add("skeleton"),t.innerHTML=`
         <div class="skeleton-image"></div>
         <div class="skeleton-text"></div>
      `,t},h=()=>{let c=window.innerWidth<=768?18:12;y.innerHTML="";for(let s=0;s<c;s++)y.appendChild(g())},n=t=>t.replace(/(\d+%|ofertas|\$\d{1,3}(\.\d{3})*(,\d+)?|\d+\s*(ml|ML)|ENVÍO\sGRATIS)/gi,c=>`<span class="iframe__categorias-span" style="font-weight: bold; color: red;">${c}</span>`),m=t=>t?/SOLO X \d+ HORAS/i.test(t)||t.toUpperCase()==="AGOTADO"?{borderColor:"red",bgColor:"red",textColor:"white",text:t.toUpperCase(),borderWidth:"3px"}:t.toUpperCase()==="LANZAMIENTO"?{borderColor:"#aad500",bgColor:"#aad500",textColor:"black",text:"LANZAMIENTO",borderWidth:"3px"}:{borderColor:"rgb(223, 223, 223)",bgColor:"transparent",textColor:"black",text:"",borderWidth:"1px"}:{borderColor:"rgb(223, 223, 223)",bgColor:"transparent",textColor:"black",text:"",borderWidth:"1px"},u=t=>{let c=new Date;c.setHours(0,0,0,0),i.innerHTML="";let s=document.createDocumentFragment();if(t.some(e=>/SOLO X \d+ HORAS/i.test(e.offerState))&&!document.querySelector('[data-category-name="SoloX"]')){let e=document.querySelector(".iframe__nav"),o=document.createElement("a");o.href="#SoloX",o.className="iframe__nav-item",o.dataset.categoryName="SoloX",o.textContent="Solo X Horas",e.appendChild(o)}t.filter(e=>{let o=new Date(e.startDate),l=new Date(e.endDate);return!e.isProductHidden&&c>=o&&c<=l}).sort((e,o)=>e.orderSellout-o.orderSellout).forEach(e=>{let o=m(e.offerState),l=d.content.cloneNode(!0),p=l.querySelector(".iframe__categorias-link"),S=l.querySelector(".iframe__categorias-image"),T=l.querySelector(".iframe__categorias-productTitle"),v=l.querySelector(".iframe__tag--desk"),C=l.querySelector(".iframe__tag--mobile");p.href=e.urlProduct,p.dataset.id=e.id,p.dataset.title=e.title,p.dataset.category=/SOLO X \d+ HORAS/i.test(e.offerState)?`${e.category} SoloX`:e.category,S.src=e.urlImage,S.alt=e.title||"Imagen de producto",S.style.border=`${o.borderWidth} solid ${o.borderColor}`,T.innerHTML=n(e.title||""),o.text?(v.style.backgroundColor=o.bgColor,v.style.color=o.textColor,v.innerHTML=`<b class="iframe__tag--bold">${o.text}</b>`,C.style.backgroundColor=o.bgColor,C.style.color=o.textColor,C.innerHTML=`<b class="iframe__tag--bold">${o.text}</b>`):(v.remove(),C.remove()),s.appendChild(l)}),i.appendChild(s),a.style.opacity="0",a.style.display="flex",f.style.display="block",setTimeout(()=>{i.classList.add("iframe__categorias-container--show"),a.style.transition="opacity 0.5s ease-in-out",a.style.opacity="1";let e=new Event("navCargado");document.dispatchEvent(e)},100)};(async()=>{try{h();let t=new Date().getTime(),s=await(await fetch(`${r}?t=${t}`,{cache:"no-store"})).json();if(!s||!Array.isArray(s)){console.error("Error: Datos no v\xE1lidos",s);return}y.style.display="none",u(s)}catch(t){console.error("Error al cargar los datos:",t)}})()});document.addEventListener("navCargado",()=>{let r=document.querySelector(".iframe__nav"),a=document.querySelectorAll(".iframe__nav-item"),f=document.querySelectorAll(".iframe__categorias-link"),y=document.querySelector(".iframe__banner"),i=document.querySelector('[data-category-name="VerTodo"]'),d="VerTodo",g=()=>{f.forEach(n=>n.style.display="block")},h=n=>{f.forEach(m=>{let b=(m.getAttribute("data-category")||"").split(" ");m.style.display=b.includes(n)?"block":"none"})};g(),a.forEach(n=>{n.addEventListener("click",function(m){m.preventDefault();let u=n.getAttribute("data-category-name");a.forEach(b=>b.classList.remove("selected","ver-todo-active")),u==="VerTodo"?(d="VerTodo",g(),n.classList.add("ver-todo-active")):(d=u,h(u)),n.classList.add("selected"),r.scrollTo({left:n.offsetLeft-r.offsetLeft,behavior:"smooth"})})}),y.addEventListener("click",()=>{d="VerTodo",g(),a.forEach(n=>n.classList.remove("selected","ver-todo-active")),i.classList.add("selected","ver-todo-active"),r.scrollTo({left:i.offsetLeft-r.offsetLeft,behavior:"smooth"})})});var x=0,E;function _(){let r=document.querySelector(".main__container");if(r){let a=r.getBoundingClientRect().height;a>0&&a!==x&&(window.parent.postMessage(a,"*"),x=a)}}window.addEventListener("load",()=>{_()});document.addEventListener("navCargado",()=>{_(),k()});function k(){let r=document.querySelector(".main__container"),a={attributes:!0,childList:!0,subtree:!0};r&&(E=new MutationObserver(_),E.observe(r,a))}setTimeout(()=>{_(),k()},4e3);var L=document.querySelector(".seo__toggle-btn");L.addEventListener("click",()=>{let r=document.getElementById("seoContent");r.style.display==="none"||r.style.display===""?(r.style.display="block",L.textContent="Ver menos"):(r.style.display="none",L.textContent="Ver m\xE1s")});})();
