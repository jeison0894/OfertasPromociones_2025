(()=>{document.addEventListener("DOMContentLoaded",async()=>{let r="https://script.google.com/macros/s/AKfycbw1KAhYbM4ZmOKAQjTlUxk5XrivtITa0pMM2ohChNpqvtkGHPoROFsTSphRPv3idbk4/exec",n=document.querySelector(".iframe__nav"),v=document.querySelector(".seo__wrapper"),m=document.querySelector(".skeleton-container"),i=document.querySelector(".iframe__categorias-container"),u=document.querySelector("#producto-template");if(!i||!u){console.error("Error: No se encontr\xF3 .iframe__categorias-container o el template");return}let g=()=>{let t=document.createElement("div");return t.classList.add("skeleton"),t.innerHTML=`
         <div class="skeleton-image"></div>
         <div class="skeleton-text"></div>
      `,t},h=()=>{let a=window.innerWidth<=768?18:12;m.innerHTML="";for(let c=0;c<a;c++)m.appendChild(g())},s=t=>t.replace(/(\d+%|ofertas|\$\d{1,3}(\.\d{3})*(,\d+)?|\d+\s*(ml|ML)|ENVÍO\sGRATIS)/gi,a=>`<span class="iframe__categorias-span" style="font-weight: bold; color: red;">${a}</span>`),y=t=>/SOLO X \d+ HORAS/i.test(t)||t.toUpperCase()==="AGOTADO"?{borderColor:"red",bgColor:"red",textColor:"white",text:t.toUpperCase(),borderWidth:"3px"}:t.toUpperCase()==="LANZAMIENTO"?{borderColor:"#aad500",bgColor:"#aad500",textColor:"black",text:"LANZAMIENTO",borderWidth:"3px"}:{borderColor:"rgb(223, 223, 223)",bgColor:"transparent",textColor:"black",text:"",borderWidth:"1px"},d=t=>{let a=new Date;a.setHours(0,0,0,0),i.innerHTML="";let c=document.createDocumentFragment();if(t.some(e=>/SOLO X \d+ HORAS/i.test(e.offerState))&&!document.querySelector('[data-category-name="SoloX"]')){let e=document.querySelector(".iframe__nav"),o=document.createElement("a");o.href="#SoloX",o.className="iframe__nav-item",o.dataset.categoryName="SoloX",o.textContent="Solo X Horas",e.appendChild(o)}t.filter(e=>{let o=new Date(e.startDate),l=new Date(e.endDate);return!e.isProductHidden&&a>=o&&a<=l}).sort((e,o)=>e.orderSellout-o.orderSellout).forEach(e=>{let o=y(e.offerState),l=u.content.cloneNode(!0),p=l.querySelector(".iframe__categorias-link"),C=l.querySelector(".iframe__categorias-image"),x=l.querySelector(".iframe__categorias-productTitle"),b=l.querySelector(".iframe__tag--desk"),S=l.querySelector(".iframe__tag--mobile");p.href=e.urlProduct,p.dataset.id=e.id,p.dataset.title=e.title,/SOLO X \d+ HORAS/i.test(e.offerState)?p.dataset.category=`${e.category} SoloX`:p.dataset.category=e.category,C.src=e.urlImage,C.alt=e.title||"Imagen de producto",C.style.border=`${o.borderWidth} solid ${o.borderColor}`,x.innerHTML=s(e.title||""),o.text?(b.style.backgroundColor=o.bgColor,b.style.color=o.textColor,b.innerHTML=`<b class="iframe__tag--bold">${o.text}</b>`,S.style.backgroundColor=o.bgColor,S.style.color=o.textColor,S.innerHTML=`<b class="iframe__tag--bold">${o.text}</b>`):(b.remove(),S.remove()),c.appendChild(l)}),i.appendChild(c),n.style.opacity="0",n.style.display="flex",v.style.display="block",setTimeout(()=>{i.classList.add("iframe__categorias-container--show"),n.style.transition="opacity 0.5s ease-in-out",n.style.opacity="1";let e=new Event("navCargado");document.dispatchEvent(e)},100)},f=async()=>{try{h();let a=await(await fetch(r)).json();if(console.log(a),!a||!Array.isArray(a)){console.error("Error: Datos no v\xE1lidos",a);return}let c=new Date().getTime();localStorage.setItem("productosData",JSON.stringify(a)),localStorage.setItem("productosTimestamp",c),m.style.display="none",d(a)}catch(t){console.error("Error al cargar los datos:",t)}};(()=>{let t=localStorage.getItem("productosData"),a=localStorage.getItem("productosTimestamp"),c=new Date().getTime(),T=5*60*1e3;if(t&&a&&c-a<T){let e=JSON.parse(t);m.style.display="none",d(e)}else f()})()});document.addEventListener("navCargado",()=>{let r=document.querySelector(".iframe__nav"),n=document.querySelectorAll(".iframe__nav-item"),v=document.querySelectorAll(".iframe__categorias-link"),m=document.querySelector(".iframe__banner"),i=document.querySelector('[data-category-name="VerTodo"]'),u="VerTodo",g=()=>{v.forEach(s=>s.style.display="block")},h=s=>{v.forEach(y=>{let f=(y.getAttribute("data-category")||"").split(" ");y.style.display=f.includes(s)?"block":"none"})};g(),n.forEach(s=>{s.addEventListener("click",function(y){y.preventDefault();let d=s.getAttribute("data-category-name");n.forEach(f=>f.classList.remove("selected","ver-todo-active")),d==="VerTodo"?(u="VerTodo",g(),s.classList.add("ver-todo-active")):(u=d,h(d)),s.classList.add("selected"),r.scrollTo({left:s.offsetLeft-r.offsetLeft,behavior:"smooth"})})}),m.addEventListener("click",()=>{u="VerTodo",g(),n.forEach(s=>s.classList.remove("selected","ver-todo-active")),i.classList.add("selected","ver-todo-active"),r.scrollTo({left:i.offsetLeft-r.offsetLeft,behavior:"smooth"})})});var k=0,E;function _(){let r=document.querySelector(".main__container");if(r){let n=r.getBoundingClientRect().height;n>0&&n!==k&&(window.parent.postMessage(n,"*"),k=n)}}window.addEventListener("load",()=>{_()});document.addEventListener("navCargado",()=>{_(),w()});function w(){let r=document.querySelector(".main__container"),n={attributes:!0,childList:!0,subtree:!0};r&&(E=new MutationObserver(_),E.observe(r,n))}setTimeout(()=>{_(),w()},4e3);var L=document.querySelector(".seo__toggle-btn");L.addEventListener("click",()=>{let r=document.getElementById("seoContent");r.style.display==="none"||r.style.display===""?(r.style.display="block",L.textContent="Ver menos"):(r.style.display="none",L.textContent="Ver m\xE1s")});})();
